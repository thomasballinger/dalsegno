<html>
<head>
<meta charset="UTF-8">
<title>Dal Segno</title>
<link rel="stylesheet" href="reset.css">
<link rel="stylesheet" href="main.css">
<link rel="stylesheet" href="embed.css">
<link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto:300" rel="stylesheet">
</head>
<body>
<div class="container">
<script src="../ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="../bundle.js"></script>

<div class="hero-container">
<h1 id="hero">Dal Segno</h1>
<img id="header-segno" src="segno.svg" alt="Dal Segno sign from music notation">
</div>

<h2>See the effect of code changes instantly</h2>
<div class="edit-to-rewind-example">
<script type="dalsegno"
        data-console="true"
        data-speed="50"
        data-editor="true"
        data-canvas-width="400"
        data-program="breakoutProgram"
        data-speed="100"
        data-theme="solarized_light"
        >
</script>
</div>
<p class="instructions">Try modifying the code! For example, change a number.</p>

<div class="rows">
  <div>
  <p>Normally when we make changes to long-running programs we have to restart them and wait for the program to get back to where the changes will make a difference.
  </p>
  </div>
  <div class="links-box">
    <ul>
      <li><a href="https://github.com/thomasballinger/dalsegno">project repo on GitHub</a></li>
      <li><a href="http://dalsegno.ballingt.com">try it fullscreen</a></li>
    </ul>
  </div>
  <div>
  <p>
  Dal Segno rewinds your program back to just before the function you changed was last executed. Hopefully this makes modifying your code as experimentation-friendly as tweaking css.
  </p>
  </div>
</div>

<h2>Language</h2>

<div class="simple-example">
<script type="dalsegno"
        data-console="true"
        data-speed="1"
        data-ast-highlight="true"
        data-canvas-width="300"
        data-program="simpleProgram"
        >
</script>
</div>

You can read the <a href="https://github.com/thomasballinger/dalsegno#language">documentation in the project readme</a>

<h2>Write games</h2>
<div class="simple-example">
<script type="dalsegno"
        data-console="true"
        data-speed="500"
        data-canvas-width="500"
        data-program="golfProgram"
        >
</script>
</div>
<p>In this golf game, it's convenient to be able to change <code>fly-loop</code> or <code>collision</code> code without restarting the program.</p>

<hr>

<p class="instructions">Use spacebar and the mouse to avoid the hidden asteroids.</p>
<div class="simple-example">
<script type="dalsegno"
        data-console="true"
        data-speed="500"
        data-canvas-width="500"
        data-program="spaceLightProgram"
        >
</script>
</div>
<p class="notes">
Try tweaking the size and shape of the floodlight (line 62), or the shape of the ship. Changing this code will rewind the program by only one frame, while changes initial conditions will return the game to the beginning of a session.
</p>

<h2>Try it out</h2>
Write your own programs at <a href="http://dalsegno.ballingt.com">dalsegno.ballingt.com</a>
and me the resulting url, and I'll post the result here!

<hr>

<h2>About</h2>

<h2>Stepping through history</h2>
<div class="stepping-example">
<script type="dalsegno"
        data-console="true"
        data-speed="50"
        data-editor="read-only"
        data-canvas-width="500"
        data-step-controls="true"
        data-program="breakoutProgram"
        >
</script>
</div>


<aside>
Dal Segno takes actual snapshots of the program state instead of recording user inputs and rerunning the program deterministically. This second approach is the more sensible way to implement hot-swapping of code, and ise
</aside>

<aside>
  Dal Segno takes snapshots of program state not every rendering frame or tick of the game, but instead. While limiting the user to specific program structures like Processing does with its <code>setup()</code> and <code>draw()</code> methods wwould make this easier to implement, Dal Segno's lack of required structures allows the user to write programs free of these constraints. In practice, such constraints are probably a good idea.
</aside>



<h3>Motivation</h3>

Code Lauren!


Project history:
<ol>
  <li>simple interpreter</li>
  <li>resumable interpreter with generators</li>
  <li>serializable interpreter with objects</li>
  <li>restart-from-edited-function behavior</li>
  <li>bytecode</li>
  <li>use immutable data structures for fast copies</li>
  <li>...uh oh, I guess that requires doing our own garbage collection of our mutable scopes</li>
</ol>


<h2>Want to use it?</h2>

Frankly I'm not sure how useful it really is. The main use case I'm thinking about it game jams. The source of this page shows the most convenient way to embed Dal Segno.

<h2>Let's make it better</h2>

There are a thousand directions I could imagine this going in. So far I've added features without much thought for product; this was a very experimental project that I've arbitrarily capped off at this point.

The main reason to work on it is probably that you're interested in language implementation and bytecode interpreters. If this describes you, then let's talk! I'd love to walk you through the coe and we can find some useful things to change.


<ul>
  <li>An alternate interpreter mode that doesn't take snapshots (and will therefore have much more predictable performance)</li>
  <li>More general JavaScript interop: currently only functions, but we could add jsSet and jsGet to deal with nested objects</li>
  <li>Methods for loading external assets by url, or at least convenience functions for interacting with img elements</li>
</ul>



<footer>
  Segno image licenced CC BY-SA, <a href="https://commons.wikimedia.org/wiki/File:SegnoTeken.svg">https://commons.wikimedia.org/wiki/File:SegnoTeken.svg</a>
</footer>
</div>

<!--

  Cut some of these later!

  Dal Segno should
  * find script tags of its type
  * whether buttons or not
  * which script to load
  * speed
  * highlight ast or not
  * rewind or not
  * text editor or not
  * canvas dimensions - pixel-by-pixel or
  * create elements to fill containing div

  Would be cool to have a slider without an editor I guess...

  -->

<script>
DalSegno.findScriptTags();
</script>
</body>
</html>
